// PlastiWatch V2 â€” Animated Character Sprites for Activity Display
//
// Provides animated character sprites for each activity type:
// - Idle: Standing character with subtle breathing animation
// - Walking: Character with leg movement animation
// - Running: Character with faster leg movement animation
// - Fall: Alert/exclamation character animation

use embedded_graphics::{
    draw_target::DrawTarget,
    geometry::{Point, Size},
    pixelcolor::BinaryColor,
    Pixel,
};
use crate::events::ActivityClass;

// Sprite dimensions (32x32 pixels for each character)
pub const SPRITE_SIZE: Size = Size::new(32, 32);
pub const SPRITE_CENTER_X: i32 = 64; // Center of 128px wide screen
pub const SPRITE_CENTER_Y: i32 = 32; // Vertical center for activity display

// Animation frame rate: update every 200ms (5 FPS) for smooth but efficient animation
pub const ANIMATION_FRAME_MS: u32 = 200;

// ---------------------------------------------------------------------------
// IDLE Animation (Standing/breathing) - 2 frames
// ---------------------------------------------------------------------------

// Simple standing person: head (circle), body (line), legs (two lines)
// Frame 0: Normal
#[rustfmt::skip]
const IDLE_FRAME_0_BYTES: [u8; 128] = [
    0x00, 0x00, 0x00, 0x00,  // Row 0-7
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,  // Row 8-15: Head (circle at y=10, x=16)
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x3C, 0x3C, 0x00,  // Head circle (12x12)
    0x00, 0x7E, 0x7E, 0x00,
    0x00, 0x7E, 0x7E, 0x00,
    0x00, 0x3C, 0x3C, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,  // Row 16-23: Body
    0x00, 0x18, 0x18, 0x00,  // Body line (vertical)
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,  // Row 24-31: Legs
    0x00, 0x18, 0x00, 0x00,  // Left leg
    0x00, 0x18, 0x00, 0x00,
    0x00, 0x18, 0x00, 0x00,
    0x00, 0x00, 0x18, 0x00,  // Right leg
    0x00, 0x00, 0x18, 0x00,
    0x00, 0x00, 0x18, 0x00,
    0x00, 0x00, 0x00, 0x00,
];

// Frame 1: Slightly expanded (breathing)
#[rustfmt::skip]
const IDLE_FRAME_1_BYTES: [u8; 128] = [
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x3C, 0x3C, 0x00,
    0x00, 0x7E, 0x7E, 0x00,
    0x00, 0x7E, 0x7E, 0x00,
    0x00, 0x3C, 0x3C, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x1C, 0x1C, 0x00,  // Slightly wider body
    0x00, 0x1C, 0x1C, 0x00,
    0x00, 0x1C, 0x1C, 0x00,
    0x00, 0x1C, 0x1C, 0x00,
    0x00, 0x1C, 0x1C, 0x00,
    0x00, 0x1C, 0x1C, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x18, 0x00, 0x00,
    0x00, 0x18, 0x00, 0x00,
    0x00, 0x18, 0x00, 0x00,
    0x00, 0x00, 0x18, 0x00,
    0x00, 0x00, 0x18, 0x00,
    0x00, 0x00, 0x18, 0x00,
    0x00, 0x00, 0x00, 0x00,
];

// ---------------------------------------------------------------------------
// WALKING Animation - 4 frames (leg movement cycle)
// ---------------------------------------------------------------------------

// Frame 0: Left leg forward
#[rustfmt::skip]
const WALK_FRAME_0: [u8; 128] = [
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x3C, 0x3C, 0x00,  // Head
    0x00, 0x7E, 0x7E, 0x00,
    0x00, 0x7E, 0x7E, 0x00,
    0x00, 0x3C, 0x3C, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x18, 0x18, 0x00,  // Body
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x30, 0x00, 0x00,  // Left leg forward
    0x00, 0x30, 0x00, 0x00,
    0x00, 0x30, 0x00, 0x00,
    0x00, 0x00, 0x0C, 0x00,  // Right leg back
    0x00, 0x00, 0x0C, 0x00,
    0x00, 0x00, 0x0C, 0x00,
    0x00, 0x00, 0x00, 0x00,
];

// Frame 1: Mid-stride
#[rustfmt::skip]
const WALK_FRAME_1: [u8; 128] = [
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x3C, 0x3C, 0x00,
    0x00, 0x7E, 0x7E, 0x00,
    0x00, 0x7E, 0x7E, 0x00,
    0x00, 0x3C, 0x3C, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x18, 0x00, 0x00,  // Legs centered
    0x00, 0x18, 0x00, 0x00,
    0x00, 0x18, 0x00, 0x00,
    0x00, 0x00, 0x18, 0x00,
    0x00, 0x00, 0x18, 0x00,
    0x00, 0x00, 0x18, 0x00,
    0x00, 0x00, 0x00, 0x00,
];

// Frame 2: Right leg forward
#[rustfmt::skip]
const WALK_FRAME_2: [u8; 128] = [
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x3C, 0x3C, 0x00,
    0x00, 0x7E, 0x7E, 0x00,
    0x00, 0x7E, 0x7E, 0x00,
    0x00, 0x3C, 0x3C, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x0C, 0x00,  // Left leg back
    0x00, 0x00, 0x0C, 0x00,
    0x00, 0x00, 0x0C, 0x00,
    0x00, 0x30, 0x00, 0x00,  // Right leg forward
    0x00, 0x30, 0x00, 0x00,
    0x00, 0x30, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
];

// Frame 3: Mid-stride (same as frame 1)
#[rustfmt::skip]
const WALK_FRAME_3: [u8; 128] = [
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x3C, 0x3C, 0x00,
    0x00, 0x7E, 0x7E, 0x00,
    0x00, 0x7E, 0x7E, 0x00,
    0x00, 0x3C, 0x3C, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x18, 0x00, 0x00,
    0x00, 0x18, 0x00, 0x00,
    0x00, 0x18, 0x00, 0x00,
    0x00, 0x00, 0x18, 0x00,
    0x00, 0x00, 0x18, 0x00,
    0x00, 0x00, 0x18, 0x00,
    0x00, 0x00, 0x00, 0x00,
];

// ---------------------------------------------------------------------------
// RUNNING Animation - 4 frames (faster leg movement, arms visible)
// ---------------------------------------------------------------------------

// Frame 0: Left leg forward, arms swinging
#[rustfmt::skip]
const RUN_FRAME_0: [u8; 128] = [
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x3C, 0x3C, 0x00,  // Head
    0x00, 0x7E, 0x7E, 0x00,
    0x00, 0x7E, 0x7E, 0x00,
    0x00, 0x3C, 0x3C, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x60, 0x00, 0x00,  // Left arm up
    0x00, 0x18, 0x18, 0x00,  // Body
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x00, 0x06, 0x00,  // Right arm down
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x60, 0x00, 0x00,  // Left leg forward
    0x00, 0x60, 0x00, 0x00,
    0x00, 0x60, 0x00, 0x00,
    0x00, 0x00, 0x06, 0x00,  // Right leg back
    0x00, 0x00, 0x06, 0x00,
    0x00, 0x00, 0x06, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
];

// Frame 1: Mid-stride
#[rustfmt::skip]
const RUN_FRAME_1: [u8; 128] = [
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x3C, 0x3C, 0x00,
    0x00, 0x7E, 0x7E, 0x00,
    0x00, 0x7E, 0x7E, 0x00,
    0x00, 0x3C, 0x3C, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x06, 0x00,  // Right arm up
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x60, 0x00, 0x00,  // Left arm down
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x18, 0x00, 0x00,  // Legs centered
    0x00, 0x18, 0x00, 0x00,
    0x00, 0x18, 0x00, 0x00,
    0x00, 0x00, 0x18, 0x00,
    0x00, 0x00, 0x18, 0x00,
    0x00, 0x00, 0x18, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
];

// Frame 2: Right leg forward
#[rustfmt::skip]
const RUN_FRAME_2: [u8; 128] = [
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x3C, 0x3C, 0x00,
    0x00, 0x7E, 0x7E, 0x00,
    0x00, 0x7E, 0x7E, 0x00,
    0x00, 0x3C, 0x3C, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x06, 0x00,  // Right arm up
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x60, 0x00, 0x00,  // Left arm down
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x06, 0x00,  // Left leg back
    0x00, 0x00, 0x06, 0x00,
    0x00, 0x00, 0x06, 0x00,
    0x00, 0x60, 0x00, 0x00,  // Right leg forward
    0x00, 0x60, 0x00, 0x00,
    0x00, 0x60, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
];

// Frame 3: Mid-stride (same as frame 1)
#[rustfmt::skip]
const RUN_FRAME_3: [u8; 128] = [
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x3C, 0x3C, 0x00,
    0x00, 0x7E, 0x7E, 0x00,
    0x00, 0x7E, 0x7E, 0x00,
    0x00, 0x3C, 0x3C, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x06, 0x00,
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x60, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x18, 0x00, 0x00,
    0x00, 0x18, 0x00, 0x00,
    0x00, 0x18, 0x00, 0x00,
    0x00, 0x00, 0x18, 0x00,
    0x00, 0x00, 0x18, 0x00,
    0x00, 0x00, 0x18, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
];

// ---------------------------------------------------------------------------
// FALL Animation - 3 frames (alert/exclamation)
// ---------------------------------------------------------------------------

// Frame 0: Exclamation mark
#[rustfmt::skip]
const FALL_FRAME_0: [u8; 128] = [
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x18, 0x18, 0x00,  // Top of exclamation
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x18, 0x18, 0x00,  // Dot
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
];

// Frame 1: Larger exclamation (pulsing)
#[rustfmt::skip]
const FALL_FRAME_1: [u8; 128] = [
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x3C, 0x3C, 0x00,  // Wider top
    0x00, 0x3C, 0x3C, 0x00,
    0x00, 0x3C, 0x3C, 0x00,
    0x00, 0x3C, 0x3C, 0x00,
    0x00, 0x3C, 0x3C, 0x00,
    0x00, 0x3C, 0x3C, 0x00,
    0x00, 0x3C, 0x3C, 0x00,
    0x00, 0x3C, 0x3C, 0x00,
    0x00, 0x3C, 0x3C, 0x00,
    0x00, 0x3C, 0x3C, 0x00,
    0x00, 0x3C, 0x3C, 0x00,
    0x00, 0x3C, 0x3C, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x3C, 0x3C, 0x00,  // Larger dot
    0x00, 0x3C, 0x3C, 0x00,
    0x00, 0x3C, 0x3C, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
];

// Frame 2: Back to normal (creates pulsing effect)
#[rustfmt::skip]
const FALL_FRAME_2: [u8; 128] = [
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x18, 0x18, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
];

// ---------------------------------------------------------------------------
// Animation State Tracker
// ---------------------------------------------------------------------------

pub struct AnimationState {
    current_frame: usize,
    frame_count: usize,
    last_update_ms: u32,
}

impl AnimationState {
    pub fn new(frame_count: usize) -> Self {
        Self {
            current_frame: 0,
            frame_count,
            last_update_ms: 0,
        }
    }

    /// Update animation frame if enough time has passed
    pub fn update(&mut self, current_ms: u32) -> bool {
        if current_ms.wrapping_sub(self.last_update_ms) >= ANIMATION_FRAME_MS {
            self.current_frame = (self.current_frame + 1) % self.frame_count;
            self.last_update_ms = current_ms;
            true
        } else {
            false
        }
    }

    pub fn current_frame(&self) -> usize {
        self.current_frame
    }

    pub fn reset(&mut self) {
        self.current_frame = 0;
        self.last_update_ms = 0;
    }
}

// ---------------------------------------------------------------------------
// Sprite Data Access
// ---------------------------------------------------------------------------

pub fn get_sprite_frame(activity: ActivityClass, frame: usize) -> &'static [u8; 128] {
    match activity {
        ActivityClass::Idle => match frame % 2 {
            0 => &IDLE_FRAME_0_BYTES,
            1 => &IDLE_FRAME_1_BYTES,
            _ => unreachable!(),
        },
        ActivityClass::UpDown => match frame % 4 {
            0 => &WALK_FRAME_0,
            1 => &WALK_FRAME_1,
            2 => &WALK_FRAME_2,
            3 => &WALK_FRAME_3,
            _ => unreachable!(),
        },
        ActivityClass::Wave => match frame % 4 {
            0 => &RUN_FRAME_0,
            1 => &RUN_FRAME_1,
            2 => &RUN_FRAME_2,
            3 => &RUN_FRAME_3,
            _ => unreachable!(),
        },
        ActivityClass::Snake => match frame % 3 {
            0 => &FALL_FRAME_0,
            1 => &FALL_FRAME_1,
            2 => &FALL_FRAME_2,
            _ => unreachable!(),
        },
    }
}

pub fn get_frame_count(activity: ActivityClass) -> usize {
    match activity {
        ActivityClass::Idle => 2,
        ActivityClass::UpDown => 4,
        ActivityClass::Wave => 4,
        ActivityClass::Snake => 3,
    }
}

// ---------------------------------------------------------------------------
// Helper: Draw sprite to display buffer
// ---------------------------------------------------------------------------

pub fn draw_sprite<D: DrawTarget<Color = BinaryColor>>(
    display: &mut D,
    sprite_data: &[u8; 128],
    position: Point,
) -> Result<(), D::Error> {
    // Sprite is 32x32 pixels
    // embedded-graphics ImageRaw expects data in row-major format
    // Each row is 32 pixels = 4 bytes (MSB first per byte)
    // We need to convert our format to embedded-graphics format
    // For now, we'll draw pixel by pixel for clarity and correctness
    
    for y in 0..32u32 {
        for x in 0..32u32 {
            let byte_idx = (y * 4 + x / 8) as usize;
            let bit_idx = 7 - (x % 8);
            let pixel_on = (sprite_data[byte_idx] >> bit_idx) & 1 == 1;
            
            if pixel_on {
                let px = position.x + x as i32;
                let py = position.y + y as i32;
                display.draw_iter(core::iter::once(Pixel(Point::new(px, py), BinaryColor::On)))?;
            }
        }
    }
    Ok(())
}
